2025-06-02 23:36:03,299 - EnhancedTrainer - INFO - 🚀 开始多模型训练和对比...
2025-06-02 23:36:03,299 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-02 23:36:03,348 - EnhancedTrainer - INFO - 📚 训练集: 56,216 条记录
2025-06-02 23:36:03,348 - EnhancedTrainer - INFO - 📋 验证集: 7,027 条记录
2025-06-02 23:36:03,348 - EnhancedTrainer - INFO - 🧪 测试集: 7,028 条记录
2025-06-02 23:36:03,348 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 03:53:21,893 - EnhancedTrainer - INFO - 🚀 开始多模型训练和对比...
2025-06-03 03:53:21,894 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 03:53:21,959 - EnhancedTrainer - INFO - 📚 训练集: 56,230 条记录
2025-06-03 03:53:21,960 - EnhancedTrainer - INFO - 📋 验证集: 7,029 条记录
2025-06-03 03:53:21,960 - EnhancedTrainer - INFO - 🧪 测试集: 7,029 条记录
2025-06-03 03:53:21,960 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:06:22,066 - EnhancedTrainer - INFO - 
============================================================
2025-06-03 04:06:22,066 - EnhancedTrainer - INFO - 🎯 开始训练 PPO_LSTM 模型
2025-06-03 04:06:22,066 - EnhancedTrainer - INFO - ============================================================
2025-06-03 04:06:22,066 - EnhancedTrainer - INFO - 🧠 开始训练 LSTM PPO 模型...
2025-06-03 04:06:23,549 - EnhancedTrainer - ERROR - ❌ PPO_LSTM 训练失败: SolUsdtTradingEnv.reset() got an unexpected keyword argument 'seed'
2025-06-03 04:06:23,550 - EnhancedTrainer - INFO - 
============================================================
2025-06-03 04:06:23,550 - EnhancedTrainer - INFO - 🎯 开始训练 PPO_STANDARD 模型
2025-06-03 04:06:23,550 - EnhancedTrainer - INFO - ============================================================
2025-06-03 04:06:23,550 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:06:23,612 - EnhancedTrainer - ERROR - ❌ PPO_STANDARD 训练失败: SolUsdtTradingEnv.reset() got an unexpected keyword argument 'seed'
2025-06-03 04:06:23,612 - EnhancedTrainer - INFO - 
============================================================
2025-06-03 04:06:23,612 - EnhancedTrainer - INFO - 🎯 开始训练 DQN 模型
2025-06-03 04:06:23,612 - EnhancedTrainer - INFO - ============================================================
2025-06-03 04:06:23,612 - EnhancedTrainer - INFO - 🧠 开始训练DQN模型...
2025-06-03 04:06:23,625 - EnhancedTrainer - ERROR - ❌ DQN 训练失败: SolUsdtTradingEnv.reset() got an unexpected keyword argument 'seed'
2025-06-03 04:06:23,630 - EnhancedTrainer - INFO - 💾 测试数据已保存至: data/test_data.pkl
2025-06-03 04:22:49,155 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:22:49,168 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:22:49,169 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:22:49,169 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:22:49,169 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:23:17,333 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:23:18,661 - EnhancedTrainer - INFO - 🎯 开始训练 50000 步...
2025-06-03 04:23:18,667 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: too many values to unpack (expected 2)
2025-06-03 04:23:18,899 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:23:18,921 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:23:18,921 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:23:18,921 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:23:18,921 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:23:45,938 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:23:46,863 - EnhancedTrainer - INFO - 🎯 开始训练 50000 步...
2025-06-03 04:23:46,867 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: too many values to unpack (expected 2)
2025-06-03 04:31:08,417 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:31:08,427 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:31:08,427 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:31:08,427 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:31:08,428 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:31:15,709 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 04:31:15,710 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:31:16,646 - EnhancedTrainer - INFO - 🎯 开始训练 50000 步...
2025-06-03 04:31:16,655 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: too many values to unpack (expected 2)
2025-06-03 04:36:49,065 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:36:49,075 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:36:49,075 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:36:49,075 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:36:49,075 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:36:56,669 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 04:36:56,673 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:36:56,673 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 04:36:56,673 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 04:36:56,676 - EnhancedTrainer - ERROR - ❌ 环境重置失败: too many values to unpack (expected 2)
2025-06-03 04:36:56,676 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: too many values to unpack (expected 2)
2025-06-03 04:36:56,683 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 490, in train_ppo_standard
    raise e
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 486, in train_ppo_standard
    test_obs = train_env.reset()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\vec_normalize.py", line 297, in reset
    obs = self.venv.reset()
          ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 78, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-06-03 04:38:34,596 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:38:34,607 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:38:34,607 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:38:34,607 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:38:34,607 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:38:41,799 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 04:38:41,799 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:38:41,800 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 04:38:41,800 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 04:38:41,800 - EnhancedTrainer - ERROR - ❌ 环境重置失败: too many values to unpack (expected 2)
2025-06-03 04:38:41,800 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: too many values to unpack (expected 2)
2025-06-03 04:38:41,800 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 490, in train_ppo_standard
    raise e
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 486, in train_ppo_standard
    test_obs = train_env.reset()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\vec_normalize.py", line 297, in reset
    obs = self.venv.reset()
          ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 78, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-06-03 04:40:20,637 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:40:20,647 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:40:20,647 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:40:20,647 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:40:20,647 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:40:27,850 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 04:40:27,861 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:40:27,861 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 04:40:27,861 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 04:40:27,866 - EnhancedTrainer - ERROR - ❌ 环境重置失败: could not broadcast input array from shape (66,) into shape (2610,)
2025-06-03 04:40:27,866 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: could not broadcast input array from shape (66,) into shape (2610,)
2025-06-03 04:40:27,867 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 490, in train_ppo_standard
    raise e
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 486, in train_ppo_standard
    test_obs = train_env.reset()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\vec_normalize.py", line 297, in reset
    obs = self.venv.reset()
          ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 79, in reset
    self._save_obs(env_idx, obs)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 109, in _save_obs
    self.buf_obs[key][env_idx] = obs
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
ValueError: could not broadcast input array from shape (66,) into shape (2610,)

2025-06-03 04:41:35,512 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:41:35,524 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:41:35,524 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:41:35,524 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:41:35,524 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:41:42,958 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 04:41:42,962 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:41:42,962 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 04:41:42,962 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 04:41:42,967 - EnhancedTrainer - ERROR - ❌ 环境重置失败: could not broadcast input array from shape (66,) into shape (2610,)
2025-06-03 04:41:42,967 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: could not broadcast input array from shape (66,) into shape (2610,)
2025-06-03 04:41:42,968 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 490, in train_ppo_standard
    raise e
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 486, in train_ppo_standard
    test_obs = train_env.reset()
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\vec_normalize.py", line 297, in reset
    obs = self.venv.reset()
          ^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 79, in reset
    self._save_obs(env_idx, obs)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 109, in _save_obs
    self.buf_obs[key][env_idx] = obs
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
ValueError: could not broadcast input array from shape (66,) into shape (2610,)

2025-06-03 04:54:36,133 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 04:54:36,142 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 04:54:36,144 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 04:54:36,144 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 04:54:36,144 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 04:54:43,536 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 04:54:43,536 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 04:54:43,536 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 04:54:43,536 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 04:54:43,546 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 04:54:43,546 - EnhancedTrainer - INFO - 🔨 初始化PPO模型...
2025-06-03 04:54:44,961 - EnhancedTrainer - INFO - ✅ PPO模型初始化成功
2025-06-03 04:54:44,962 - EnhancedTrainer - INFO - 🎯 开始训练（无回调模式）...
2025-06-03 04:54:45,005 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: not enough values to unpack (expected 5, got 4)
2025-06-03 04:54:45,005 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 504, in train_ppo_standard
    model.learn(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\ppo\ppo.py", line 311, in learn
    return super().learn(
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\base_vec_env.py", line 222, in step
    return self.step_wait()
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\vec_normalize.py", line 181, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
                                 ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 5, got 4)

2025-06-03 05:01:29,998 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 05:01:30,006 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 05:01:30,006 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 05:01:30,006 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 05:01:30,007 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 05:01:37,848 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 05:01:37,848 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 05:01:37,850 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 05:01:37,850 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 05:01:37,853 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 05:01:37,853 - EnhancedTrainer - INFO - 🔨 初始化PPO模型...
2025-06-03 05:01:38,854 - EnhancedTrainer - INFO - ✅ PPO模型初始化成功
2025-06-03 05:01:38,854 - EnhancedTrainer - INFO - 🎯 开始训练（无回调模式）...
2025-06-03 05:01:38,876 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: 'SolUsdtTradingEnv' object has no attribute 'trailing_stop_activation'
2025-06-03 05:01:38,883 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 504, in train_ppo_standard
    model.learn(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\ppo\ppo.py", line 311, in learn
    return super().learn(
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\base_vec_env.py", line 222, in step
    return self.step_wait()
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\vec_normalize.py", line 181, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
                                 ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\environment\trading_env.py", line 1182, in step
    self._update_risk_management_stats(current_price, should_force_exit, exit_reason)
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\environment\trading_env.py", line 1219, in _update_risk_management_stats
    if current_pnl_pct >= self.trailing_stop_activation and not self.trailing_stop_active:
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SolUsdtTradingEnv' object has no attribute 'trailing_stop_activation'

2025-06-03 05:04:22,814 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 05:04:22,826 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 05:04:22,826 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 05:04:22,826 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 05:04:22,826 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 05:04:30,213 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 05:04:30,214 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 05:04:30,216 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 05:04:30,217 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 05:04:30,220 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 05:04:30,220 - EnhancedTrainer - INFO - 🔨 初始化PPO模型...
2025-06-03 05:04:31,169 - EnhancedTrainer - INFO - ✅ PPO模型初始化成功
2025-06-03 05:04:31,169 - EnhancedTrainer - INFO - 🎯 开始训练（无回调模式）...
2025-06-03 05:08:59,491 - EnhancedTrainer - INFO - ✅ PPO标准模型训练完成
2025-06-03 05:08:59,491 - EnhancedTrainer - INFO - 💾 模型已保存: ./models/ppo_standard_final_1748898539.zip
2025-06-03 05:09:00,364 - EnhancedTrainer - ERROR - ❌ 快速测试失败: You have passed a tuple to the predict() function instead of a Numpy array or a Dict. You are probably mixing Gym API with SB3 VecEnv API: `obs, info = env.reset()` (Gym) vs `obs = vec_env.reset()` (SB3 VecEnv). See related issue https://github.com/DLR-RM/stable-baselines3/issues/1694 and documentation for more information: https://stable-baselines3.readthedocs.io/en/master/guide/vec_envs.html#vecenv-api-vs-gym-api
2025-06-03 05:17:40,110 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 05:17:40,132 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 05:17:40,132 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 05:17:40,132 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 05:17:40,132 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 05:17:47,384 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 05:17:47,384 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 05:17:47,384 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 05:17:47,384 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 05:17:47,389 - EnhancedTrainer - ERROR - ❌ 环境重置失败: not enough values to unpack (expected 2, got 1)
2025-06-03 05:17:47,389 - EnhancedTrainer - ERROR - ❌ PPO标准模型训练失败: not enough values to unpack (expected 2, got 1)
2025-06-03 05:17:47,396 - EnhancedTrainer - ERROR - 错误详情: Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 500, in train_ppo_standard
    raise e
  File "C:\Users\Administrator\Desktop\量化交易系统\PO3 approach\training\enhanced_trainer.py", line 496, in train_ppo_standard
    test_obs, test_info = train_env.reset()  # ✅ 正确解包reset()返回的元组
    ^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

2025-06-03 05:21:59,248 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 05:21:59,257 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 05:21:59,258 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 05:21:59,258 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 05:21:59,258 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 05:22:06,969 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 05:22:06,969 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 05:22:06,978 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 05:22:06,979 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 05:22:06,979 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 05:22:06,979 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 05:22:06,982 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 05:22:06,982 - EnhancedTrainer - INFO - 🔨 初始化PPO模型...
2025-06-03 05:22:08,293 - EnhancedTrainer - INFO - ✅ PPO模型初始化成功
2025-06-03 05:22:08,293 - EnhancedTrainer - INFO - 🎯 开始训练（无回调模式）...
2025-06-03 05:27:30,539 - EnhancedTrainer - INFO - ✅ PPO标准模型训练完成
2025-06-03 05:27:30,539 - EnhancedTrainer - INFO - 💾 模型已保存: ./models/ppo_standard_final_1748899650.zip
2025-06-03 05:27:32,342 - EnhancedTrainer - INFO - ✅ 快速测试完成: 收益率=0.00%, 夏普比率=0.000
2025-06-03 09:49:43,942 - EnhancedTrainer - INFO - 🔄 准备训练数据...
2025-06-03 09:49:43,949 - EnhancedTrainer - INFO - 📚 训练集: 2,004 条记录
2025-06-03 09:49:43,949 - EnhancedTrainer - INFO - 📋 验证集: 250 条记录
2025-06-03 09:49:43,949 - EnhancedTrainer - INFO - 🧪 测试集: 251 条记录
2025-06-03 09:49:43,949 - EnhancedTrainer - INFO - 🏗️ 创建训练环境...
2025-06-03 09:49:51,161 - EnhancedTrainer - INFO - ✅ 环境创建成功 - 训练环境数量: 1
2025-06-03 09:49:51,161 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 09:49:51,170 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 09:49:51,170 - EnhancedTrainer - INFO - 🧠 开始训练标准PPO模型...
2025-06-03 09:49:51,173 - EnhancedTrainer - INFO - 🔧 创建PPO模型...
2025-06-03 09:49:51,173 - EnhancedTrainer - INFO - 🧪 测试环境重置...
2025-06-03 09:49:51,175 - EnhancedTrainer - INFO - ✅ 环境重置成功，观测形状: (1, 66)
2025-06-03 09:49:51,176 - EnhancedTrainer - INFO - 🔨 初始化PPO模型...
2025-06-03 09:49:52,111 - EnhancedTrainer - INFO - ✅ PPO模型初始化成功
2025-06-03 09:49:52,113 - EnhancedTrainer - INFO - 🎯 开始训练（无回调模式）...
2025-06-03 09:57:54,898 - EnhancedTrainer - INFO - ✅ PPO标准模型训练完成
2025-06-03 09:57:54,899 - EnhancedTrainer - INFO - 💾 模型已保存: ./models/ppo_standard_final_1748915874.zip
2025-06-03 09:57:56,741 - EnhancedTrainer - INFO - 📊 开始快速测试，最大步数: 151
2025-06-03 09:57:58,227 - EnhancedTrainer - INFO - ✅ 快速测试完成: 收益率=0.00%, 夏普比率=0.000
2025-06-03 09:57:58,227 - EnhancedTrainer - INFO - 📊 测试详情: 步数=151/151, 交易次数=0, 胜率=0.00%
2025-06-03 09:57:58,243 - EnhancedTrainer - INFO - 💰 资产变化: $10000.00 → $10000.00
