# ğŸš€ å¼ºåŒ–å­¦ä¹ äº¤æ˜“ç³»ç»Ÿ (PO3 Approach)

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Build Status](https://img.shields.io/badge/build-passing-brightgreen.svg)]()

åŸºäº**å¯è§£é‡Šæ€§å¼ºåŒ–å­¦ä¹ **çš„**SOL/USDT**ä¸­é«˜é¢‘åˆçº¦äº¤æ˜“ç³»ç»Ÿï¼Œé›†æˆ**PO3(Power of Three)**ç†è®ºã€**SMC(Smart Money Concepts)**ä¿¡å·åˆ†æä¸ç°ä»£å¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ§  å¯è§£é‡Šæ€§AIé›†æˆ
- **SHAPå€¼åˆ†æ**: ç‰¹å¾é‡è¦æ€§å’Œè´¡çŒ®åº¦å®æ—¶åˆ†æ
- **æ³¨æ„åŠ›æœºåˆ¶**: æ¨¡å‹å†³ç­–è¿‡ç¨‹å¯è§†åŒ–
- **ç­–ç•¥è§„åˆ™æå–**: ç¬¦å·åŒ–å†³ç­–è§„åˆ™è‡ªåŠ¨ç”Ÿæˆ
- **å†³ç­–æ—¥å¿—ç³»ç»Ÿ**: å®Œæ•´çš„å†³ç­–è·¯å¾„è®°å½•ä¸å›æº¯

### ğŸ“Š é«˜çº§æŠ€æœ¯åˆ†æ
- **SMCä¿¡å·è¯†åˆ«**: PO3é˜¶æ®µã€BOSã€Order Blockã€Liquidity Sweep
- **å¤šæ—¶é—´æ¡†æ¶åˆ†æ**: æ”¯æŒ1åˆ†é’Ÿåˆ°æ—¥çº¿çš„å¤šå‘¨æœŸä¿¡å·èåˆ
- **åŠ¨æ€æŠ€æœ¯æŒ‡æ ‡**: RSIã€MACDã€å¸ƒæ—å¸¦ã€ATRç­‰å¢å¼ºç‰ˆæŒ‡æ ‡
- **å¸‚åœºç»“æ„åˆ†æ**: è¶‹åŠ¿è¯†åˆ«ã€æ”¯æ’‘é˜»åŠ›ã€Fair Value Gap

### ğŸ¤– å¼ºåŒ–å­¦ä¹ ç®—æ³•
- **PPO-LSTM**: æ”¯æŒé•¿çŸ­æœŸè®°å¿†çš„ç­–ç•¥ä¼˜åŒ–
- **æ³¨æ„åŠ›æœºåˆ¶PPO**: é›†æˆTransformeræ³¨æ„åŠ›çš„ç­–ç•¥ç½‘ç»œ
- **DQN**: æ·±åº¦Qç½‘ç»œç¦»æ•£åŠ¨ä½œç©ºé—´å­¦ä¹ 
- **å¤šæ¨¡å‹é›†æˆ**: è‡ªåŠ¨æ¨¡å‹é€‰æ‹©ä¸æ€§èƒ½æ¯”è¾ƒ

### ğŸ›¡ï¸ é«˜çº§é£é™©æ§åˆ¶
- **åŠ¨æ€ä»“ä½ç®¡ç†**: Kellyå…¬å¼ã€æ³¢åŠ¨ç‡ç›®æ ‡ã€é£é™©å¹³ä»·
- **å¤šå±‚æ­¢æŸæœºåˆ¶**: ATRè‡ªé€‚åº”ã€æŠ€æœ¯ä½ã€ç§»åŠ¨æ­¢ç›ˆ
- **å®æ—¶é£é™©ç›‘æ§**: æœ€å¤§å›æ’¤ã€è¿ç»­äºæŸã€æ³¢åŠ¨ç‡å¼‚å¸¸æ£€æµ‹
- **è‡ªé€‚åº”æ æ†**: åŸºäºå¸‚åœºçŠ¶æ€çš„æ™ºèƒ½æ æ†è°ƒæ•´

### ğŸ“ˆ å®æ—¶äº¤æ˜“éƒ¨ç½²
- **Binance APIé›†æˆ**: æ”¯æŒç°è´§å’ŒæœŸè´§å®æ—¶äº¤æ˜“
- **WebSocketæ•°æ®æµ**: æ¯«ç§’çº§å¸‚åœºæ•°æ®æ¥æ”¶
- **æ¨¡æ‹Ÿäº¤æ˜“æ¨¡å¼**: å®‰å…¨çš„ç­–ç•¥éªŒè¯ç¯å¢ƒ
- **æ€§èƒ½ç›‘æ§çœ‹æ¿**: å®æ—¶P&Lã€èƒœç‡ã€é£é™©æŒ‡æ ‡å±•ç¤º

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
å¼ºåŒ–å­¦ä¹ äº¤æ˜“ç³»ç»Ÿ/
â”œâ”€â”€ ğŸ“ analysis/                    # ğŸ” åˆ†æä¸å¯è§£é‡Šæ€§æ¨¡å—
â”‚   â”œâ”€â”€ model_explainer.py         # SHAPå€¼åˆ†æå™¨
â”‚   â”œâ”€â”€ rule_extractor.py          # ç­–ç•¥è§„åˆ™æå–å™¨
â”‚   â”œâ”€â”€ trading_visualizer.py      # äº¤æ˜“å¯è§†åŒ–åˆ†æ
â”‚   â””â”€â”€ feature_analyzer.py        # ç‰¹å¾é‡è¦æ€§åˆ†æ
â”œâ”€â”€ ğŸ“ data/                        # ğŸ“Š æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ data_collector.py          # å¤šæºæ•°æ®æ”¶é›†å™¨
â”‚   â”œâ”€â”€ feature_engineering.py     # é«˜çº§ç‰¹å¾å·¥ç¨‹
â”‚   â”œâ”€â”€ technical_indicators.py    # æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
â”‚   â”œâ”€â”€ smc_signals.py            # SMCä¿¡å·ç”Ÿæˆ
â”‚   â””â”€â”€ signal_filter.py          # ä¿¡å·è¿‡æ»¤ä¸å¢å¼º
â”œâ”€â”€ ğŸ“ environment/                 # ğŸ® äº¤æ˜“ç¯å¢ƒæ¨¡å—
â”‚   â”œâ”€â”€ trading_env.py             # Gymäº¤æ˜“ç¯å¢ƒ
â”‚   â”œâ”€â”€ balanced_reward_function.py # å¹³è¡¡å¥–åŠ±å‡½æ•°
â”‚   â”œâ”€â”€ dynamic_position_manager.py # åŠ¨æ€ä»“ä½ç®¡ç†
â”‚   â””â”€â”€ enhanced_risk_control.py   # å¢å¼ºé£é™©æ§åˆ¶
â”œâ”€â”€ ğŸ“ models/                      # ğŸ§  æ¨¡å‹æ¶æ„æ¨¡å—
â”‚   â”œâ”€â”€ attention_policy.py        # æ³¨æ„åŠ›æœºåˆ¶ç­–ç•¥ç½‘ç»œ
â”‚   â””â”€â”€ ensemble_model.py          # æ¨¡å‹é›†æˆæ¡†æ¶
â”œâ”€â”€ ğŸ“ training/                    # ğŸ¯ è®­ç»ƒä¼˜åŒ–æ¨¡å—
â”‚   â”œâ”€â”€ enhanced_trainer.py        # å¢å¼ºè®­ç»ƒå™¨
â”‚   â””â”€â”€ model_comparator.py        # æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ
â”œâ”€â”€ ğŸ“ deployment/                  # ğŸš€ éƒ¨ç½²æ¨¡å—
â”‚   â””â”€â”€ live_trader.py             # å®æ—¶äº¤æ˜“ç³»ç»Ÿ
â”œâ”€â”€ ğŸ“ utils/                       # ğŸ› ï¸ å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ decision_logger.py         # å†³ç­–æ—¥å¿—è®°å½•
â”‚   â””â”€â”€ config_manager.py          # é…ç½®ç®¡ç†å™¨
â”œâ”€â”€ explainability_config.yaml     # å¯è§£é‡Šæ€§é…ç½®æ–‡ä»¶
â”œâ”€â”€ explainability_integration_guide.py  # é›†æˆæŒ‡å—
â”œâ”€â”€ main.py                         # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ quick_start.py                 # å¿«é€Ÿå¼€å§‹ç¤ºä¾‹
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/rl-trading-system.git
cd rl-trading-system

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®è®¾ç½®

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp explainability_config.yaml.example explainability_config.yaml

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®APIå¯†é’¥å’Œå‚æ•°
nano explainability_config.yaml
```

### 3. æ•°æ®æ”¶é›†ä¸é¢„å¤„ç†

```python
# å¿«é€Ÿæ•°æ®æ”¶é›†ç¤ºä¾‹
from data.data_collector import DataCollector
from data.feature_engineering import EnhancedFeatureEngineer

# æ”¶é›†å†å²æ•°æ®
collector = DataCollector()
df = collector.get_historical_data(
    symbol='SOLUSDT',
    timeframe='15m',
    limit=5000
)

# ç‰¹å¾å·¥ç¨‹
engineer = EnhancedFeatureEngineer()
df_features = engineer.engineer_comprehensive_features(df)
```

### 4. æ¨¡å‹è®­ç»ƒ

```python
# ä½¿ç”¨å¢å¼ºè®­ç»ƒå™¨
from training.enhanced_trainer import EnhancedTrainer

trainer = EnhancedTrainer()
model_paths = trainer.train_multiple_models(df_features)
print(f"è®­ç»ƒå®Œæˆçš„æ¨¡å‹: {model_paths}")
```

### 5. å¯è§£é‡Šæ€§åˆ†æ

```python
# é›†æˆå¯è§£é‡Šæ€§åˆ†æ
from explainability_integration_guide import IntegratedExplainabilitySystem

explainer = IntegratedExplainabilitySystem(
    state_dim=len(df_features.columns),
    action_dim=3
)

# åˆ†æäº¤æ˜“å†³ç­–
analysis = explainer.analyze_trading_decision(
    state=current_state,
    action=action_taken,
    reward=reward_received,
    model=trained_model
)
```

### 6. å›æµ‹éªŒè¯

```python
# è¿è¡Œå®Œæ•´å›æµ‹
python main.py --mode backtest --model best_ppo_lstm.zip
```

### 7. å®æ—¶äº¤æ˜“(è°¨æ…ä½¿ç”¨)

```python
# æ¨¡æ‹Ÿäº¤æ˜“æ¨¡å¼
python main.py --mode live --dry-run True

# å®ç›˜äº¤æ˜“(éœ€è¦å……åˆ†æµ‹è¯•)
python main.py --mode live --dry-run False
```

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### ğŸ” å¯è§£é‡Šæ€§åˆ†æç³»ç»Ÿ

```python
# SHAPå€¼åˆ†æ
shap_analyzer = RLModelExplainer(model, feature_names)
shap_result = shap_analyzer.analyze_single_decision(state, action)

# æ³¨æ„åŠ›æƒé‡å¯è§†åŒ–
attention_policy = AttentionActorCriticPolicy(state_dim, action_dim)
attention_weights = attention_policy.get_attention_weights(state)

# ç­–ç•¥è§„åˆ™æå–
rule_extractor = TradingRuleExtractor(feature_names)
rules = rule_extractor.extract_decision_tree_rules(states, actions)
```

### ğŸ“Š æŠ€æœ¯åˆ†æä¸ä¿¡å·ç”Ÿæˆ

```python
# SMCä¿¡å·åˆ†æ
smc = SMCSignals()
df_with_smc = smc.calculate_all_smc_signals(df)

# æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
tech_indicators = TechnicalIndicators()
df_with_tech = tech_indicators.calculate_enhanced_indicators(df)

# ä¿¡å·è¿‡æ»¤ä¸å¢å¼º
signal_filter = EnhancedSignalFilter()
df_filtered = signal_filter.apply_enhanced_signal_filter(df)
```

### ğŸ›¡ï¸ é£é™©ç®¡ç†ç³»ç»Ÿ

```python
# åŠ¨æ€ä»“ä½ç®¡ç†
position_manager = DynamicPositionManager()
position_size, details = position_manager.calculate_position_size(
    account_balance=10000,
    current_price=current_price,
    stop_loss_price=stop_loss,
    signal_strength=0.8
)

# å¢å¼ºé£é™©æ§åˆ¶
risk_controller = EnhancedRiskController()
stop_loss = risk_controller.calculate_hybrid_stop_loss(
    df, current_idx, entry_price, position_type
)
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§ä¸åˆ†æ

### äº¤æ˜“æ€§èƒ½æŒ‡æ ‡
- **å¹´åŒ–æ”¶ç›Šç‡**: ç­–ç•¥çš„å¹´åŒ–æ”¶ç›Šè¡¨ç°
- **æœ€å¤§å›æ’¤**: å†å²æœ€å¤§èµ„é‡‘å›æ’¤å¹…åº¦
- **å¤æ™®æ¯”ç‡**: é£é™©è°ƒæ•´åæ”¶ç›Š
- **ç›ˆäºæ¯”**: å¹³å‡ç›ˆåˆ©/å¹³å‡äºæŸ
- **èƒœç‡**: ç›ˆåˆ©äº¤æ˜“å æ¯”
- **å¡å°”é©¬æ¯”ç‡**: å¹´åŒ–æ”¶ç›Š/æœ€å¤§å›æ’¤

### é£é™©æ§åˆ¶æŒ‡æ ‡
- **VaR(é£é™©ä»·å€¼)**: ç»™å®šç½®ä¿¡åº¦ä¸‹çš„æœ€å¤§æŸå¤±
- **æ æ†æ•ˆç‡**: æ æ†ä½¿ç”¨çš„æœ‰æ•ˆæ€§
- **è¿ç»­äºæŸ**: æœ€å¤§è¿ç»­äºæŸæ¬¡æ•°
- **ä»“ä½åˆ©ç”¨ç‡**: ä»“ä½ä½¿ç”¨æ•ˆç‡

## âš™ï¸ é…ç½®è¯´æ˜

### ä¸»è¦é…ç½®æ–‡ä»¶

1. **explainability_config.yaml**: å¯è§£é‡Šæ€§ç³»ç»Ÿé…ç½®
2. **environment/reward_config.py**: å¥–åŠ±å‡½æ•°é…ç½®
3. **trainingé…ç½®**: è®­ç»ƒå‚æ•°è°ƒä¼˜
4. **deploymenté…ç½®**: å®æ—¶äº¤æ˜“å‚æ•°

### å…³é”®å‚æ•°

```yaml
# å¯è§£é‡Šæ€§é…ç½®ç¤ºä¾‹
shap:
  explainer_type: "permutation"
  n_samples: 100
  top_k_features: 10

# é£é™©æ§åˆ¶é…ç½®
risk_control:
  max_position_ratio: 0.5
  stop_loss_atr_multiplier: 2.0
  max_drawdown_threshold: 0.15

# å¥–åŠ±å‡½æ•°é…ç½®
reward_function:
  alpha_win: 1.0
  beta_loss: 1.5
  gamma_drawdown: 2.0
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰ç­–ç•¥å¼€å‘

```python
# ç»§æ‰¿åŸºç¡€äº¤æ˜“ç¯å¢ƒ
class CustomTradingEnv(SolUsdtTradingEnv):
    def _calculate_custom_reward(self, action, price, idx):
        # å®ç°è‡ªå®šä¹‰å¥–åŠ±é€»è¾‘
        pass
    
    def _add_custom_features(self, df):
        # æ·»åŠ è‡ªå®šä¹‰ç‰¹å¾
        pass
```

### æ¨¡å‹é›†æˆä¸ä¼˜åŒ–

```python
# å¤šæ¨¡å‹é›†æˆ
from training.model_comparator import ModelComparator

comparator = ModelComparator()
ranking = comparator.generate_model_ranking(model_results)
best_model = ranking.iloc[0]['model_name']
```

### å®æ—¶ç›‘æ§çœ‹æ¿

```python
# åˆ›å»ºç»¼åˆåˆ†æçœ‹æ¿
dashboard_path = explainer.create_comprehensive_dashboard()
print(f"çœ‹æ¿å·²ä¿å­˜è‡³: {dashboard_path}")
```

## ğŸ“š æŠ€æœ¯æ–‡æ¡£

### ç®—æ³•åŸç†
- **PPOç®—æ³•**: Proximal Policy Optimizationçš„å®ç°ç»†èŠ‚
- **SHAPåˆ†æ**: SHapley Additive exPlanationsåœ¨äº¤æ˜“å†³ç­–ä¸­çš„åº”ç”¨
- **SMCç†è®º**: Smart Money Conceptsçš„é‡åŒ–å®ç°
- **æ³¨æ„åŠ›æœºåˆ¶**: Transformeræ³¨æ„åŠ›åœ¨åºåˆ—å†³ç­–ä¸­çš„åº”ç”¨

### APIå‚è€ƒ
è¯¦ç»†çš„APIæ–‡æ¡£è¯·å‚è€ƒå„æ¨¡å—çš„docstringå’Œç±»å‹æ³¨è§£ã€‚

## ğŸš¨ é£é™©æç¤º

âš ï¸ **é‡è¦å£°æ˜**:
- æœ¬é¡¹ç›®ä»…ä¾›**å­¦ä¹ ç ”ç©¶**ä½¿ç”¨ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®
- é‡åŒ–äº¤æ˜“å­˜åœ¨é‡å¤§**èµ„é‡‘æŸå¤±é£é™©**
- å®ç›˜äº¤æ˜“å‰è¯·å……åˆ†**å›æµ‹éªŒè¯**
- å»ºè®®å…ˆåœ¨**æ¨¡æ‹Ÿç¯å¢ƒ**ä¸­æµ‹è¯•ç­–ç•¥
- è¯·æ ¹æ®è‡ªèº«é£é™©æ‰¿å—èƒ½åŠ›è°ƒæ•´ä»“ä½

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦æƒ…è¯·å‚è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ! è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤:

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®é—®é¢˜: [GitHub Issues](https://github.com/your-repo/issues)
- æŠ€æœ¯è®¨è®º: [Discussions](https://github.com/your-repo/discussions)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºå¼€æºé‡åŒ–äº¤æ˜“ç¤¾åŒºåšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç ”ç©¶è€…ã€‚

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ç»™ä¸ªStaræ”¯æŒ! â­** 